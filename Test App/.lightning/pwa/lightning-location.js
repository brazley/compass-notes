// lightning-location.js â€” generated by Lightning for Notes
(function() {
  'use strict';
  if (!window.lightning) return;

  window.lightning.location = {
    version: '0.1.0',

    isAvailable: function() {
      return !!navigator.geolocation;
    },

    // options: { enableHighAccuracy?, timeout?, maximumAge? }
    // Returns Promise<GeolocationPosition>
    getCurrentPosition: function(options) {
      return new Promise(function(resolve, reject) {
        if (!navigator.geolocation) {
          reject(new Error('Geolocation not supported'));
          return;
        }
        navigator.geolocation.getCurrentPosition(resolve, function(err) {
          reject(new Error(err.message));
        }, options);
      });
    },

    // Returns watchId (pass to clearWatch to stop)
    watchPosition: function(callback, errorCallback, options) {
      if (!navigator.geolocation) return null;
      return navigator.geolocation.watchPosition(callback, errorCallback, options);
    },

    clearWatch: function(watchId) {
      if (navigator.geolocation && watchId != null) {
        navigator.geolocation.clearWatch(watchId);
      }
    }
  };
})();