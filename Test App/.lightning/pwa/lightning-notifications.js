// lightning-notifications.js â€” generated by Lightning for Notes
(function() {
  'use strict';
  if (!window.lightning) return;

  window.lightning.notifications = {
    version: '0.1.0',

    isAvailable: function() {
      return 'Notification' in window;
    },

    getPermission: function() {
      if (!('Notification' in window)) return 'unsupported';
      return Notification.permission; // 'default' | 'granted' | 'denied'
    },

    // Returns Promise<'granted'|'denied'>
    requestPermission: function() {
      if (!('Notification' in window)) return Promise.resolve('denied');
      if (Notification.permission === 'granted') return Promise.resolve('granted');
      return Notification.requestPermission();
    },

    // title: string
    // options: { body?, icon?, badge?, tag?, silent?, data? }
    // Returns Notification | null
    send: function(title, options) {
      if (!('Notification' in window)) return null;
      if (Notification.permission !== 'granted') return null;
      return new Notification(title, options || {});
    },

    // Full flow: request permission then send
    // Returns Promise<Notification|null>
    ask: function(title, options) {
      var self = this;
      return this.requestPermission().then(function(permission) {
        if (permission !== 'granted') return null;
        return self.send(title, options);
      });
    }
  };

})();